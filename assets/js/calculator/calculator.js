!function(){var e=null,t=null,n=null,s=null,i=null,a=null,l=null,o=null,r=null,u=null,c=null,p=null,f=null,m=null,v=null,d=null,h=null,g=null,j={},I=null,S=function(){function e(e){s=$("#"+e),s.addClass("is-infra-active"),s.parent().parent().siblings().addClass("is-infra-selected")}function a(e){var t=$.ajax({url:"/api/index.php/estimate",type:"POST",data:e,crossDomain:!0});t.then(function(e){var t=JSON.stringify(e);sessionStorage.setItem("result",t),window.location.href="/resumen"},function(e){console.log(e)})}var l=initAnalytics();if(I=JSON.parse(sessionStorage.getItem("result")),I&&(e(I.results.options.infraestructura),$('input[name="infraestructura"][value="'+I.results.options.infraestructura+'"]').attr("checked",!0),$('input[name="A"]').val(I.results.options.A),$('input[name="B"]').val(I.results.options.B),$('input[name="D"]').val(I.results.options.D),$('input[name="E"]').val(I.results.options.E),$('input[name="F"]').val(I.results.options.F),$('input[name="G"]').val(I.results.options.G),$('input[name="H"]').val(I.results.options.H),$('input[name="I"]').val(I.results.options.I),$('input[name="J"]').val(I.results.options.J),$('input[name="K"]').val(I.results.options.K),$('input[name="L"][value="'+I.results.options.L+'"]').attr("checked",!0),$('input[name="M"][value="'+I.results.options.M+'"]').attr("checked",!0),$('input[name="N"][value="'+I.results.options.N+'"]').attr("checked",!0)),o=$("#estado").selectize({onChange:function(e){j.estado=this.$control[0].textContent,j.estadoId=e,sessionStorage.getItem("place")||sessionStorage.setItem("place",JSON.stringify(j)),c.disable(),c.clearOptions(),c.load(function(t){v&&v.abort(),v=$.ajax({url:"./assets/municipios/"+e+".json",success:function(e){c.enable(),t(e)},error:function(){t()}})})}}),r=$("#municipio").selectize({valueField:"id",labelField:"text",searchField:["text"],onChange:function(e){j.municipio=this.$control[0].textContent,j.municipioId=e,sessionStorage.setItem("place",JSON.stringify(j))}}),u=o[0].selectize,c=r[0].selectize,sessionStorage.getItem("place")){var S=JSON.parse(sessionStorage.getItem("place"));u.setValue(S.estadoId)}c.disable(),n.on("change",function(n){n.preventDefault(),t=this.getAttribute("value"),previousProject=s,currentInfrastructure=$("#"+t),previousProject&&(currentInfrastructure?[previousProject.removeClass("is-infra-active"),i.removeClass("is-infra-selected")]:[currentInfrastructure.removeClass("is-infra-active"),i.removeClass("is-infra-selected")]),typeProject=t,e(typeProject)}),p.on("click",function(e){function t(e,t){var n={};for(var s in e)n[s]=e[s];for(var s in t)n[s]=t[s];return n}e.preventDefault(),f.parsley().validate()?(d=f.serializeObject(),h={C:"null"},d=t(h,d),d=JSON.stringify(d),a(d)):(setTimeout(function(){g.slideUp("slow")},3e3),g.slideDown("slow")),l.clickGetCost()}),$.fn.serializeObject=function(){var e={},t=this.serializeArray();return $.each(t,function(){e[this.name]?(e[this.name].push||(e[this.name]=[e[this.name]]),e[this.name].push(this.value||"")):e[this.name]=this.value||""}),e},m.on("click",function(){t=this.getAttribute("data-twitter"),l.clickTwitterAuthor(t)})};e=$("body, html"),n=$(".js-tipo-ciclovia"),i=$(".js-selected-infra"),a=$("#estado"),l=$("#municipio"),p=$(".js-costo"),f=$(".js-calculator-form"),g=$(".js-novalid-form"),m=$(".js-twitter"),S()}(jQuery);